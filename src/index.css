@import 'tailwindcss';
@import 'tw-animate-css';

@theme {
  /* Forge warm palette — light */
  --color-forge-paper: #faf8f5;
  --color-forge-surface: #f2efeb;
  --color-forge-border: #e2ddd6;
  --color-forge-border-subtle: #ebe7e1;
  --color-forge-muted: #c9c2b8;
  --color-forge-text-secondary: #8a8279;
  --color-forge-text: #2c2825;
  --color-forge-accent: #d97706;
  --color-forge-accent-hover: #b45309;
  --color-forge-accent-subtle: #fef3c7;

  /* Forge warm palette — dark */
  --color-forge-paper-dark: #1c1a17;
  --color-forge-surface-dark: #252220;
  --color-forge-border-dark: #3a3530;
  --color-forge-border-subtle-dark: #302c28;
  --color-forge-muted-dark: #6b6560;
  --color-forge-text-secondary-dark: #a09890;
  --color-forge-text-dark: #f0ede8;
  --color-forge-accent-dark: #f59e0b;
  --color-forge-accent-hover-dark: #fbbf24;
  --color-forge-accent-subtle-dark: #451a03;

  /* Graph node type colors — light */
  --color-forge-node-decision: #fef7ed;
  --color-forge-node-decision-border: #e8a84c;
  --color-forge-node-decision-text: #a16207;

  --color-forge-node-component: #f5f0e6;
  --color-forge-node-component-border: #8b7355;
  --color-forge-node-component-text: #6b5b3e;

  --color-forge-node-task: #faf5f0;
  --color-forge-node-task-border: #c87941;
  --color-forge-node-task-text: #9a5b2f;

  --color-forge-node-note: #f5f3f0;
  --color-forge-node-note-border: #a09890;
  --color-forge-node-note-text: #706860;

  --color-forge-node-subsystem: #f7f2ea;
  --color-forge-node-subsystem-border: #9a7b4f;
  --color-forge-node-subsystem-text: #7a6030;

  --color-forge-node-assembly: #f2f0ed;
  --color-forge-node-assembly-border: #7a8070;
  --color-forge-node-assembly-text: #5a6050;

  --color-forge-node-module: #f5f0f0;
  --color-forge-node-module-border: #a07070;
  --color-forge-node-module-text: #805050;

  /* Graph node type colors — dark */
  --color-forge-node-decision-dark: #2a1f10;
  --color-forge-node-decision-border-dark: #e8a84c;
  --color-forge-node-decision-text-dark: #f0c060;

  --color-forge-node-component-dark: #1f1c16;
  --color-forge-node-component-border-dark: #a08860;
  --color-forge-node-component-text-dark: #c0a878;

  --color-forge-node-task-dark: #261c14;
  --color-forge-node-task-border-dark: #d08a50;
  --color-forge-node-task-text-dark: #e0a060;

  --color-forge-node-note-dark: #201e1c;
  --color-forge-node-note-border-dark: #807870;
  --color-forge-node-note-text-dark: #b0a8a0;

  --color-forge-node-subsystem-dark: #221e14;
  --color-forge-node-subsystem-border-dark: #b09060;
  --color-forge-node-subsystem-text-dark: #d0b070;

  --color-forge-node-assembly-dark: #1c1e1a;
  --color-forge-node-assembly-border-dark: #8a9080;
  --color-forge-node-assembly-text-dark: #a8b098;

  --color-forge-node-module-dark: #221a1a;
  --color-forge-node-module-border-dark: #b08080;
  --color-forge-node-module-text-dark: #d0a0a0;

  /* Graph edge colors */
  --color-forge-edge-dependency: #b87333;
  --color-forge-edge-dependency-selected: #9a5b2f;
  --color-forge-edge-reference: #a09890;
  --color-forge-edge-reference-selected: #706860;
  --color-forge-edge-containment: #8b7355;
  --color-forge-edge-containment-selected: #6b5b3e;

  /* Font overrides */
  --font-mono: 'JetBrains Mono', 'IBM Plex Mono', ui-monospace, monospace;
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
}

/* Custom base styles */
@layer base {
  :root {
    font-synthesis: none;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    @apply bg-forge-paper text-forge-text dark:bg-forge-paper-dark dark:text-forge-text-dark;
  }
}

/* Forge keyframe animations */
@layer utilities {
  @keyframes forge-card-enter {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes forge-pulse {
    0%,
    100% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(0.85);
      opacity: 0.4;
    }
  }

  .forge-card-enter {
    animation: forge-card-enter 300ms ease-out both;
  }

  .forge-pulse {
    animation: forge-pulse 1.5s ease-in-out infinite;
  }

  @keyframes forge-status-tick {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.3);
    }
    100% {
      transform: scale(1);
    }
  }

  .forge-status-tick {
    animation: forge-status-tick 200ms ease-out;
  }

  @media (prefers-reduced-motion: reduce) {
    .forge-card-enter {
      animation: none;
      opacity: 1;
      transform: none;
    }

    .forge-pulse {
      animation: none;
      opacity: 1;
      transform: none;
    }

    .forge-status-tick {
      animation: none;
      transform: none;
    }
  }
}

/* Graph view overrides */
@layer components {
  /* Engineering grid background — warm paper with fine grid lines */
  .forge-engineering-grid {
    background-color: var(--color-forge-paper);
    background-image:
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 23.5px,
        color-mix(in srgb, var(--color-forge-border-subtle) 60%, transparent)
          23.5px,
        color-mix(in srgb, var(--color-forge-border-subtle) 60%, transparent)
          24px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 23.5px,
        color-mix(in srgb, var(--color-forge-border-subtle) 60%, transparent)
          23.5px,
        color-mix(in srgb, var(--color-forge-border-subtle) 60%, transparent)
          24px
      ),
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 119px,
        var(--color-forge-border-subtle) 119px,
        var(--color-forge-border-subtle) 120px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 119px,
        var(--color-forge-border-subtle) 119px,
        var(--color-forge-border-subtle) 120px
      );
  }

  :is(.dark) .forge-engineering-grid {
    background-color: var(--color-forge-paper-dark);
    background-image:
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 23.5px,
        color-mix(
            in srgb,
            var(--color-forge-border-subtle-dark) 60%,
            transparent
          )
          23.5px,
        color-mix(
            in srgb,
            var(--color-forge-border-subtle-dark) 60%,
            transparent
          )
          24px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 23.5px,
        color-mix(
            in srgb,
            var(--color-forge-border-subtle-dark) 60%,
            transparent
          )
          23.5px,
        color-mix(
            in srgb,
            var(--color-forge-border-subtle-dark) 60%,
            transparent
          )
          24px
      ),
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 119px,
        var(--color-forge-border-subtle-dark) 119px,
        var(--color-forge-border-subtle-dark) 120px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 119px,
        var(--color-forge-border-subtle-dark) 119px,
        var(--color-forge-border-subtle-dark) 120px
      );
  }

  /* React Flow controls — warm surface */
  .react-flow__controls {
    background: var(--color-forge-surface) !important;
    border-color: var(--color-forge-border) !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05) !important;
  }

  .react-flow__controls-button:hover {
    background: var(--color-forge-paper) !important;
  }

  :is(.dark) .react-flow__controls {
    background: var(--color-forge-surface-dark) !important;
    border-color: var(--color-forge-border-dark) !important;
  }

  :is(.dark) .react-flow__controls-button:hover {
    background: var(--color-forge-paper-dark) !important;
  }

  /* React Flow minimap — warm surface */
  .react-flow__minimap {
    background: var(--color-forge-surface) !important;
    border-color: var(--color-forge-border) !important;
  }

  :is(.dark) .react-flow__minimap {
    background: var(--color-forge-surface-dark) !important;
    border-color: var(--color-forge-border-dark) !important;
  }
}
