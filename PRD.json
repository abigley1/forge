{
  "version": "2.0.0",
  "status": "active",
  "lastUpdated": "2026-01-20T00:00:00Z",
  "projectName": "Forge",
  "description": "A personal project brainstorming, planning, and tracking tool for complex hardware and engineering projects.",
  "metadata": {
    "source": "SPRINT_PLAN.md",
    "generatedFrom": "sprint-plan",
    "availableTools": {
      "testing": ["playwright", "vitest", "react-testing-library"],
      "backend": ["supabase"],
      "codeAnalysis": ["serena", "pr-review-toolkit"],
      "design": [
        "frontend-design",
        "rams",
        "ui-skills",
        "web-interface-guidelines"
      ]
    }
  },
  "objectives": [
    {
      "id": "obj-0",
      "sprint": 0,
      "title": "Project Infrastructure & Tooling",
      "description": "Establish development environment with CI/CD, testing, and core tooling",
      "demoGoal": "Running dev server with base layout, all CI checks passing"
    },
    {
      "id": "obj-1",
      "sprint": 1,
      "title": "Data Model & File System Foundation",
      "description": "Define TypeScript types, implement file parsing/serialization, create file system abstraction",
      "demoGoal": "Load sample project folder, display parsed nodes as JSON in UI"
    },
    {
      "id": "obj-2",
      "sprint": 2,
      "title": "Node CRUD & Basic Editor",
      "description": "Create, read, update, delete nodes through UI with markdown editing",
      "demoGoal": "Create a new Task node, edit content, see it persist and reload"
    },
    {
      "id": "obj-3",
      "sprint": 3,
      "title": "Outline View & Navigation",
      "description": "Hierarchical outline view with filtering, sorting, and keyboard navigation",
      "demoGoal": "Browse project in outline, filter by type/tag, collapse/expand sections"
    },
    {
      "id": "obj-4",
      "sprint": 4,
      "title": "Wiki-Links & Backlinks",
      "description": "Full wiki-link support with autocomplete, navigation, and backlinks",
      "demoGoal": "Type [[, see suggestions, click link to navigate, view backlinks panel"
    },
    {
      "id": "obj-5",
      "sprint": 5,
      "title": "Graph View Foundation",
      "description": "Interactive graph visualization with nodes and edges",
      "demoGoal": "View project as graph, pan/zoom, click nodes, see link connections"
    },
    {
      "id": "obj-6",
      "sprint": 6,
      "title": "DAG Dependencies & Critical Path",
      "description": "Full dependency tracking with blocking logic and critical path highlighting",
      "demoGoal": "Create task dependencies, see blocked status propagate, highlight critical path"
    },
    {
      "id": "obj-7",
      "sprint": 7,
      "title": "Decision Node Tools",
      "description": "Full decision workflow with comparison tables, scoring, and implications",
      "demoGoal": "Create decision, add options, score criteria, select winner, see implications"
    },
    {
      "id": "obj-8",
      "sprint": 8,
      "title": "Import & Export",
      "description": "Full import/export for Markdown, JSON, and CSV formats",
      "demoGoal": "Export project as JSON, re-import, export components as CSV BOM"
    },
    {
      "id": "obj-9",
      "sprint": 9,
      "title": "Command Palette & Search",
      "description": "Command palette for quick actions and global full-text search",
      "demoGoal": "Press Cmd+K, search for node, execute action, navigate instantly"
    },
    {
      "id": "obj-10",
      "sprint": 10,
      "title": "Polish & Accessibility Audit",
      "description": "Production-ready UI with full WCAG 2.1 compliance",
      "demoGoal": "Pass accessibility audit, demonstrate with screen reader"
    },
    {
      "id": "obj-11",
      "sprint": 11,
      "title": "Workspace Management & Git Integration",
      "description": "Multi-project workspace and optional git integration",
      "demoGoal": "Switch between projects, see git status, auto-commit on save"
    },
    {
      "id": "obj-12",
      "sprint": 12,
      "title": "Self-Hosted Deployment (Tailscale + Home Assistant)",
      "description": "Deploy Forge as a self-hosted application accessible via Tailscale VPN on Home Assistant",
      "demoGoal": "Access Forge from any Tailscale-connected device, data persists on Home Assistant storage"
    }
  ],
  "tasks": [
    {
      "id": "0.1",
      "sprint": 0,
      "title": "React + TypeScript Project Setup",
      "description": "Initialize Vite + React 18 + TypeScript with strict mode, path aliases, and environment configuration",
      "acceptanceCriteria": [
        "npm run build succeeds with zero errors",
        "strict: true and noImplicitAny: true in tsconfig.json",
        "Imports using @ prefix resolve correctly (@/components, @/lib, @/types)",
        ".env.example exists with documented variables",
        "Env variables accessible via import.meta.env",
        "config.ts provides typed config access"
      ]
    },
    {
      "id": "0.2",
      "sprint": 0,
      "title": "Tailwind CSS Configuration",
      "description": "Install and configure Tailwind CSS v3+ with animations and utility functions",
      "acceptanceCriteria": [
        "Tailwind classes apply correctly",
        "Content paths include all component files",
        "tailwindcss-animate animation classes available",
        "cn() utility function merges conflicting classes correctly (unit tested)"
      ]
    },
    {
      "id": "0.3",
      "sprint": 0,
      "title": "Testing Infrastructure",
      "description": "Set up Vitest + React Testing Library with coverage reporting",
      "acceptanceCriteria": [
        "npm test command runs Vitest",
        "RTL matchers available in tests",
        "Coverage report generated on test run (target: 80%+)",
        "Smoke test passes (App renders without crash)"
      ]
    },
    {
      "id": "0.4",
      "sprint": 0,
      "title": "Linting & Formatting",
      "description": "Configure ESLint + Prettier with pre-commit hooks",
      "acceptanceCriteria": [
        "npm run lint command available",
        "eslint-plugin-jsx-a11y rules active",
        "React hooks rules configured (exhaustive deps)",
        "Tailwind classes auto-sorted on format",
        "Pre-commit hook runs lint and format via Husky + lint-staged",
        ".vscode/settings.json configured for format-on-save"
      ]
    },
    {
      "id": "0.5",
      "sprint": 0,
      "title": "CI Pipeline",
      "description": "GitHub Actions workflow for lint, type-check, test, build",
      "acceptanceCriteria": [
        "CI workflow file exists at .github/workflows/ci.yml",
        "All CI steps run on every PR",
        "node_modules cached for faster CI runs"
      ]
    },
    {
      "id": "0.6",
      "sprint": 0,
      "title": "Base Layout Shell",
      "description": "Create AppShell with sidebar, main content, and accessibility features",
      "tools": ["frontend-design", "ui-skills", "rams"],
      "acceptanceCriteria": [
        "AppShell renders with two-column layout (sidebar + main)",
        "Skip link receives focus on Tab and activates with Enter",
        "Layout uses h-dvh (dynamic viewport height)",
        "Semantic landmarks used: <nav>, <main>, <aside>"
      ]
    },
    {
      "id": "0.7",
      "sprint": 0,
      "title": "Base UI Integration",
      "description": "Install and configure Base UI components with styling wrapper",
      "tools": ["ui-skills", "playwright"],
      "acceptanceCriteria": [
        "Base UI installed with pinned version",
        "Styling wrapper applies consistent Tailwind styling",
        "Usage examples documented in component files",
        "Dialog component opens and closes correctly (tested)"
      ]
    },
    {
      "id": "0.8",
      "sprint": 0,
      "title": "State Management",
      "description": "Set up Zustand store with devtools middleware",
      "acceptanceCriteria": [
        "Zustand package installed",
        "Root store initializes with devtools visible",
        "TypeScript types defined for store state and actions"
      ]
    },
    {
      "id": "0.9",
      "sprint": 0,
      "title": "Error Handling",
      "description": "Create error boundaries with fallback UI",
      "acceptanceCriteria": [
        "ErrorBoundary catches render errors and displays fallback",
        "Errors logged to console with stack trace",
        "Major app sections wrapped (sidebar, main, editor)"
      ]
    },
    {
      "id": "0.10",
      "sprint": 0,
      "title": "Toast Notifications",
      "description": "Toast system with variants and auto-dismiss",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "ToastProvider context provides value",
        "useToast() hook returns toast functions",
        "Success, error, info, undo variants styled distinctly",
        "Toast auto-dismisses after configurable timeout"
      ]
    },
    {
      "id": "0.11",
      "sprint": 0,
      "title": "Utility Functions",
      "description": "Create debug logging and z-index scale utilities",
      "acceptanceCriteria": [
        "debug('namespace') utility with localStorage toggle",
        "z-index.ts exports Z_DROPDOWN=10, Z_STICKY=20, Z_MODAL=30, Z_POPOVER=40, Z_TOAST=50, Z_TOOLTIP=60",
        "formatDate() using Intl.DateTimeFormat",
        "formatRelativeTime() for '2 hours ago' style formatting"
      ]
    },
    {
      "id": "1.1",
      "sprint": 1,
      "title": "Node Type System",
      "description": "Define TypeScript types for Decision, Component, Task, Note nodes with type guards",
      "acceptanceCriteria": [
        "NodeType enum: decision, component, task, note",
        "BaseNode interface with id, type, title, tags, dates, content",
        "DecisionNode extends BaseNode with status, selected, options, criteria",
        "ComponentNode extends BaseNode with status, cost, supplier, partNumber, customFields",
        "TaskNode extends BaseNode with status, priority, dependsOn, blocks, checklist",
        "NoteNode extends BaseNode (minimal additions)",
        "Type guards: isDecisionNode(), isComponentNode(), isTaskNode(), isNoteNode()",
        "ForgeNode discriminated union narrows correctly with type guards"
      ]
    },
    {
      "id": "1.2",
      "sprint": 1,
      "title": "Project & Workspace Types",
      "description": "Define Project and Workspace interfaces with metadata",
      "acceptanceCriteria": [
        "Project interface with id, name, path, nodes, metadata",
        "Workspace interface with projects, activeProjectId, config",
        "WorkspaceConfig interface defined"
      ]
    },
    {
      "id": "1.3",
      "sprint": 1,
      "title": "YAML Frontmatter Parsing & Serialization",
      "description": "Parse and serialize YAML frontmatter with gray-matter, including wiki-link extraction",
      "acceptanceCriteria": [
        "gray-matter installed with safe YAML config",
        "parseFrontmatter(content) returns { data, content, error }",
        "Handles edge cases: no frontmatter, malformed YAML, empty file",
        "serializeFrontmatter(node) preserves field ordering (type first, then status)",
        "Round-trip parse/serialize produces identical data (tested)",
        "parseMarkdownBody(content) extracts title from first # heading",
        "extractWikiLinks(markdown) uses regex /\\[\\[([^\\]]+)\\]\\]/g",
        "Wiki-links inside code blocks and inline code are ignored",
        "Tests pass for parsing all four node type samples"
      ]
    },
    {
      "id": "1.4",
      "sprint": 1,
      "title": "Runtime Validation with Zod",
      "description": "Create Zod schemas for node type validation",
      "acceptanceCriteria": [
        "zod package installed",
        "Zod schema defined for each node type frontmatter",
        "validateNode(data) returns Result<ForgeNode, ValidationError> with detailed error messages"
      ]
    },
    {
      "id": "1.5",
      "sprint": 1,
      "title": "File System Abstraction",
      "description": "Create adapter pattern for browser and memory file systems",
      "acceptanceCriteria": [
        "FileSystemAdapter interface: readFile, writeFile, listDirectory, exists, mkdir, watch",
        "MemoryFileSystemAdapter implements CRUD operations for tests",
        "BrowserFileSystemAdapter uses File System Access API with permission handling",
        "Directory handles cached for performance",
        "Fallback using <input type='file' webkitdirectory> works in Firefox/Safari",
        "watch() method detects external file changes",
        "Rapid changes debounced (100ms)"
      ]
    },
    {
      "id": "1.6",
      "sprint": 1,
      "title": "Project Loading & Saving",
      "description": "Load projects from directory structure and save nodes",
      "acceptanceCriteria": [
        "loadProject(adapter, path) scans decisions/, components/, tasks/, notes/",
        "Builds nodes Map with correct types",
        "Load mock project verifies node count and types",
        "saveNode(adapter, projectPath, node) determines subdirectory from node type",
        "Filenames generated via slugify (URL-safe)",
        "fixtures/sample-project/ contains at least 2 nodes of each type with cross-node links",
        "<DebugProjectView> shows node count by type, parse errors, collapsible sections"
      ]
    },
    {
      "id": "2.1",
      "sprint": 2,
      "title": "Nodes Store",
      "description": "Zustand store for node CRUD operations with project integration",
      "acceptanceCriteria": [
        "useNodesStore with nodes Map and activeNodeId",
        "Actions: addNode, updateNode, deleteNode, setActiveNode",
        "Selectors: getNodeById, getNodesByType, getAllNodes",
        "generateNodeId(title, type) slugifies and ensures uniqueness",
        "useProjectStore with project, isDirty, isLoading, error",
        "Project store integrates with file system adapter for save/load"
      ]
    },
    {
      "id": "2.2",
      "sprint": 2,
      "title": "Undo/Redo System",
      "description": "Action history with keyboard shortcuts",
      "acceptanceCriteria": [
        "Undo stack records action history",
        "Zustand middleware intercepts store actions",
        "Undo/redo works for node create, update, delete",
        "Ctrl/Cmd+Z triggers undo, Ctrl/Cmd+Shift+Z triggers redo"
      ]
    },
    {
      "id": "2.3",
      "sprint": 2,
      "title": "Sidebar Navigation",
      "description": "Sidebar with project switcher, filters, tag cloud, and quick create buttons",
      "tools": ["frontend-design", "ui-skills", "web-interface-guidelines"],
      "acceptanceCriteria": [
        "Sidebar renders with project switcher, quick create, filters, tag cloud sections",
        "Sidebar collapses at mobile breakpoint",
        "+ Decision, + Component, + Task, + Note quick create buttons"
      ]
    },
    {
      "id": "2.4",
      "sprint": 2,
      "title": "Node List View",
      "description": "Keyboard-navigable node list with icons and badges",
      "tools": ["frontend-design", "rams"],
      "acceptanceCriteria": [
        "NodeList displays type icon, title, status badge",
        "Active node visually distinct",
        "Arrow keys, Enter for keyboard navigation",
        "NodeTypeIcon shows correct lucide-react icon per type with aria-hidden",
        "StatusBadge shows color + text (not color-only)",
        "EmptyState component with single CTA renders when no nodes"
      ]
    },
    {
      "id": "2.5",
      "sprint": 2,
      "title": "Markdown Editor",
      "description": "CodeMirror-based markdown editing with syntax highlighting",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "CodeMirror packages installed (@codemirror/state, view, lang-markdown, @uiw/react-codemirror)",
        "MarkdownEditor wrapper component renders, value changes trigger onChange",
        "Markdown syntax highlighted",
        "Editor theme consistent with app"
      ]
    },
    {
      "id": "2.6",
      "sprint": 2,
      "title": "Node Detail Panel",
      "description": "Slide-out panel for node editing with frontmatter fields",
      "tools": ["frontend-design", "ui-skills", "rams"],
      "acceptanceCriteria": [
        "NodeDetailPanel renders as slide-out or split view",
        "Close button works, Escape key closes panel",
        "overscroll-behavior: contain prevents scroll bleed",
        "Focus trapped when panel open, returns on close",
        "NodeTitleEditor with large heading input, auto-focus on new node",
        "StatusSelect using Base UI Select, keyboard accessible",
        "TagInput with autocomplete, Enter to add, backspace to remove",
        "PrioritySelector as segmented control (High/Medium/Low)",
        "FrontmatterEditor renders appropriate fields based on node type",
        "Decision fields: selected option, status",
        "Component fields: cost, supplier, part number, custom key-value fields",
        "Task fields: priority, depends-on",
        "Checklist parser for - [ ] and - [x] syntax",
        "ChecklistEditor: Space to toggle, Enter to add, backspace to delete"
      ]
    },
    {
      "id": "2.7",
      "sprint": 2,
      "title": "Node Creation Dialog",
      "description": "Dialog for creating new nodes with type selection",
      "tools": ["frontend-design", "ui-skills"],
      "acceptanceCriteria": [
        "CreateNodeDialog with type selector, title input, template dropdown",
        "Ctrl+Shift+N opens create dialog"
      ]
    },
    {
      "id": "2.8",
      "sprint": 2,
      "title": "Node Deletion & Auto-Save",
      "description": "Delete confirmation and debounced auto-save with dirty tracking",
      "acceptanceCriteria": [
        "DeleteNodeDialog shows title, type, warns about broken links",
        "Undo toast appears after deletion, restores node",
        "Dirty state tracked per node",
        "Debounced auto-save (2 second delay)",
        "'Saving...' indicator visible during save",
        "beforeunload handler warns when navigating with unsaved changes"
      ]
    },
    {
      "id": "3.1",
      "sprint": 3,
      "title": "Outline View",
      "description": "Hierarchical collapsible outline by node type with keyboard navigation",
      "tools": ["frontend-design", "rams"],
      "acceptanceCriteria": [
        "OutlineView with collapsible sections by node type",
        "Collapse state persists in localStorage",
        "groupNodesByType(nodes) handles empty groups",
        "CollapsibleSection animates height, Enter/Space toggle",
        "Respects prefers-reduced-motion",
        "Keyboard navigation: Arrow up/down, Enter, Home/End, type-ahead",
        "Quick status toggle on task nodes: pending -> in_progress -> complete",
        "ViewToggle switches Outline/Graph, Ctrl+1/Ctrl+2 shortcuts"
      ]
    },
    {
      "id": "3.2",
      "sprint": 3,
      "title": "Filtering System",
      "description": "Filter by type, tag, status with URL sync",
      "tools": ["frontend-design", "rams"],
      "acceptanceCriteria": [
        "nuqs v2+ installed and NuqsAdapter configured at app root",
        "TypeFilter with toggle buttons, state stored in URL",
        "TagFilter with multi-select AND logic, stored in URL",
        "StatusFilter with checkboxes, stored in URL",
        "NodeSearchInput with 150ms debounce, clear button",
        "aria-live announces result count for screen readers",
        "TagCloud shows tags with counts, click adds to filter"
      ]
    },
    {
      "id": "3.3",
      "sprint": 3,
      "title": "Sorting",
      "description": "Sort by type, status, modified, title, created",
      "acceptanceCriteria": [
        "SortDropdown with Type, Status, Modified, Title, Created options",
        "Ascending/descending toggle stored in URL",
        "sortNodes(nodes, sortBy, direction) performs stable sort"
      ]
    },
    {
      "id": "3.4",
      "sprint": 3,
      "title": "Drag and Drop Reordering",
      "description": "DnD Kit integration for custom node ordering",
      "acceptanceCriteria": [
        "@dnd-kit/core and @dnd-kit/sortable installed",
        "DnD context provider mounts without error",
        "Node list items draggable with visual feedback",
        "Custom order persists to project metadata after reload"
      ]
    },
    {
      "id": "3.5",
      "sprint": 3,
      "title": "URL-Based Navigation",
      "description": "Deep linking with nuqs for node selection and breadcrumbs",
      "tools": ["rams"],
      "acceptanceCriteria": [
        "Active node ID synced to URL (?node=id)",
        "Browser back/forward navigation works",
        "Breadcrumbs show Project > Node Type > Node, clickable segments"
      ]
    },
    {
      "id": "3.6",
      "sprint": 3,
      "title": "List Virtualization",
      "description": "Virtualize node lists for performance",
      "acceptanceCriteria": [
        "@tanstack/react-virtual installed",
        "NodeList virtualized for >50 items",
        "200+ nodes render without frame drops"
      ]
    },
    {
      "id": "4.1",
      "sprint": 4,
      "title": "Link Index",
      "description": "Bidirectional link index for outgoing and backlinks",
      "acceptanceCriteria": [
        "buildLinkIndex(nodes) returns outgoing and incoming Maps",
        "linkIndex added to nodes store, rebuilds on node changes"
      ]
    },
    {
      "id": "4.2",
      "sprint": 4,
      "title": "Wiki-Link Autocomplete",
      "description": "CodeMirror autocomplete for [[ syntax with suggestions",
      "tools": ["/rams"],
      "acceptanceCriteria": [
        "Autocomplete source filters nodes by typed text after [[",
        "Trigger on [[, insert on Enter, dismiss on Escape",
        "Auto-link suggestions for node title mentions (subtle underline, click converts)",
        "aria-live announces link inserted, navigating, result count"
      ]
    },
    {
      "id": "4.3",
      "sprint": 4,
      "title": "Clickable Links & Navigation",
      "description": "Navigate to linked nodes via Cmd+Click with preview",
      "acceptanceCriteria": [
        "CodeMirror decoration: underline, pointer cursor for [[links]]",
        "Cmd/Ctrl+Click navigates to linked node",
        "Hover preview tooltip shows title, type badge, first 100 chars",
        "'Create Linked Node' action for non-existent links prompts for type"
      ]
    },
    {
      "id": "4.4",
      "sprint": 4,
      "title": "Backlinks Panel",
      "description": "Panel showing all nodes linking to current node",
      "tools": ["/frontend-design"],
      "acceptanceCriteria": [
        "BacklinksPanel lists linking nodes with context snippet",
        "RelatedNodes shows outgoing + incoming links grouped"
      ]
    },
    {
      "id": "4.5",
      "sprint": 4,
      "title": "Link Validation",
      "description": "Detect broken links and handle renames",
      "acceptanceCriteria": [
        "Broken links styled: red, dashed underline",
        "Warning count badge in editor toolbar",
        "Link renaming dialog offers to update all references when node title changes"
      ]
    },
    {
      "id": "5.1",
      "sprint": 5,
      "title": "React Flow Integration",
      "description": "Graph view container with node selection and filtering",
      "acceptanceCriteria": [
        "reactflow package installed",
        "GraphView container renders empty graph with controls",
        "nodesToGraphData(nodes, linkIndex) returns React Flow arrays with positions",
        "Node selection synced with store (click selects, visual ring)",
        "Node positions stored in project.json, persist across reload",
        "Graph connected to same filters as outline (hide/show nodes)",
        "Node context menu: Edit, Delete, View, Add Link"
      ]
    },
    {
      "id": "5.2",
      "sprint": 5,
      "title": "Custom Graph Nodes",
      "description": "Styled graph nodes by type with badges",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "GraphNode displays title, type icon, status badge (44x44px min)",
        "Different colors per node type using Tailwind tokens",
        "Node clustering by tag with expand/collapse (optional)"
      ]
    },
    {
      "id": "5.3",
      "sprint": 5,
      "title": "Graph Edges",
      "description": "Custom edges for dependencies and references",
      "acceptanceCriteria": [
        "Dependency edge: solid line with arrow",
        "Reference edge: dashed line with circle",
        "Edge colors: blue for dependencies, gray for references"
      ]
    },
    {
      "id": "5.4",
      "sprint": 5,
      "title": "Auto Layout",
      "description": "elkjs-based hierarchical layout",
      "acceptanceCriteria": [
        "elkjs package installed",
        "calculateLayout(nodes, edges) returns valid positions respecting DAG",
        "'Reset Layout' button repositions nodes logically"
      ]
    },
    {
      "id": "5.5",
      "sprint": 5,
      "title": "Graph Navigation & Accessibility",
      "description": "Pan, zoom, minimap, keyboard navigation with screen reader support",
      "tools": ["rams"],
      "acceptanceCriteria": [
        "Mouse wheel zoom and click-drag pan work smoothly",
        "Zoom controls UI: +/-/fit buttons, fit-to-view centers all nodes",
        "Minimap toggleable, reflects graph state",
        "Keyboard navigation: Tab focus, arrow keys, Enter, Escape",
        "Screen reader support: aria-label, announce on focus",
        "Respects prefers-reduced-motion"
      ]
    },
    {
      "id": "6.1",
      "sprint": 6,
      "title": "Dependency Graph Data Structure",
      "description": "DAG data structure with cycle detection and topological sort",
      "acceptanceCriteria": [
        "DependencyGraph class with addNode, addEdge, removeNode, removeEdge, getEdges",
        "Validates DAG (rejects cyclic dependencies)",
        "wouldCreateCycle(graph, fromId, toId) uses DFS for detection",
        "topologicalSort(graph) handles disconnected subgraphs"
      ]
    },
    {
      "id": "6.2",
      "sprint": 6,
      "title": "Blocked Status & Propagation",
      "description": "Automatic blocked status calculation and cascade",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "calculateBlockedStatus(node, allNodes) checks Task complete / Decision pending",
        "Status change cascades, toast shows newly unblocked nodes",
        "BlockedIndicator tooltip lists blocking nodes, click navigates",
        "Hover 'Mark Complete' shows tooltip of nodes to unblock"
      ]
    },
    {
      "id": "6.3",
      "sprint": 6,
      "title": "Critical Path",
      "description": "Critical path calculation and visualization",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "calculateCriticalPath(nodes, graph) finds longest chain through incomplete tasks",
        "Critical path highlighted in graph view (edges and nodes), toggleable",
        "'Critical' badge shown in outline view with optional filter",
        "Dependencies visually distinct, arrow direction correct"
      ]
    },
    {
      "id": "6.4",
      "sprint": 6,
      "title": "Dependency Editor",
      "description": "UI for managing node dependencies",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "DependencyEditor with multi-select dropdown, chips, cycle prevention",
        "'Blocks' display shows nodes blocked by current node"
      ]
    },
    {
      "id": "6.5",
      "sprint": 6,
      "title": "Milestones",
      "description": "Milestone field with grouping in outline",
      "acceptanceCriteria": [
        "Optional milestone: string field on TaskNode parses/serializes",
        "MilestoneSelector dropdown with auto-complete, create new inline",
        "Milestone grouping in outline with progress indicator, collapse/expand"
      ]
    },
    {
      "id": "7.1",
      "sprint": 7,
      "title": "Comparison Table",
      "description": "Decision comparison with options and criteria",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "DecisionOption type: id, name, values: Record<criterionId, string | number>",
        "Criterion type: id, name, weight, unit",
        "ComparisonTable with rows = criteria, columns = options",
        "'Add Option' column creates new column, focuses name cell",
        "'Add Criterion' row with name input, unit dropdown, weight slider",
        "Cell editing: click to edit, Tab navigation, Escape to cancel",
        "Option deletion with confirmation, removes from all criteria",
        "Criterion deletion with confirmation"
      ]
    },
    {
      "id": "7.2",
      "sprint": 7,
      "title": "Weighted Scoring",
      "description": "Score calculation with weight sliders and visualization",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "Weight slider 0-10, normalized score formula correct",
        "Score bar visualization, tabular-nums, highest highlighted"
      ]
    },
    {
      "id": "7.3",
      "sprint": 7,
      "title": "Option Selection & Status",
      "description": "Select decision winner with rationale and implications",
      "acceptanceCriteria": [
        "'Select' button updates status to selected, records option ID",
        "Selection rationale text area, auto-populated, editable",
        "Implications section parsed from ## Implications, displayed as links",
        "Decision status timeline: Created, Last Updated, Selected dates",
        "'Reopen Decision' reverts to pending, preserves history"
      ]
    },
    {
      "id": "7.4",
      "sprint": 7,
      "title": "Templates",
      "description": "Decision and node templates",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "Pre-defined templates: Component Selection, Design Choice, Vendor Selection",
        "Template type: id, type, name, frontmatter, content",
        "Template manager: list, create, edit, delete, duplicate",
        "Template dropdown in CreateNodeDialog pre-fills content"
      ]
    },
    {
      "id": "8.1",
      "sprint": 8,
      "title": "JSON Export/Import",
      "description": "Full project export and import with validation",
      "acceptanceCriteria": [
        "ExportService interface with export(project, format, options)",
        "exportToJSON(project) with pretty-print, all data, export metadata",
        "importFromJSON(json) validates with zod, handles version migrations"
      ]
    },
    {
      "id": "8.2",
      "sprint": 8,
      "title": "Markdown Export/Import",
      "description": "Export to markdown file structure and import",
      "acceptanceCriteria": [
        "exportNodeToMarkdown(node) outputs frontmatter + body matching spec",
        "exportProjectToMarkdown(project) creates correct directory structure",
        "importFromMarkdown(files) parses directory, handles malformed files, merge option"
      ]
    },
    {
      "id": "8.3",
      "sprint": 8,
      "title": "CSV Export",
      "description": "Components CSV and BOM export",
      "acceptanceCriteria": [
        "exportComponentsToCSV(nodes) with proper CSV escaping, Excel-compatible",
        "exportBOM(project) outputs Bill of Materials format with summed costs"
      ]
    },
    {
      "id": "8.4",
      "sprint": 8,
      "title": "Import/Export UI",
      "description": "Dialogs for import and export with drag-drop support",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "ExportDialog with format selection, options, preview, download",
        "ImportDialog with file/folder picker, format auto-detection, conflict resolution",
        "Drag-and-drop import with drop zone overlay",
        "Clipboard import (Ctrl/Cmd+V) detects format",
        "Export progress indicator with cancellation"
      ]
    },
    {
      "id": "9.1",
      "sprint": 9,
      "title": "Command Palette",
      "description": "Cmd+K command palette with fuzzy search",
      "tools": ["frontend-design"],
      "acceptanceCriteria": [
        "CommandPalette using Base UI Dialog with input, results list, keyboard navigation",
        "useHotkey(key, callback, options) hook for Cmd+K / Ctrl+K",
        "Node search with fuzzy match, type icon, title, status; Enter navigates",
        "Fuzzy search with Levenshtein matching, highlight matched chars",
        "Recent commands: last 10, show when query empty, persist"
      ]
    },
    {
      "id": "9.2",
      "sprint": 9,
      "title": "Full-Text Search",
      "description": "Search across all node content with highlighting",
      "acceptanceCriteria": [
        "Full-text search index using minisearch, indexes titles and body",
        "Index updates on node changes",
        "Search results show context snippet with highlighted match",
        "Bold matched characters, show match location"
      ]
    },
    {
      "id": "9.3",
      "sprint": 9,
      "title": "Command Registry",
      "description": "Registered commands with shortcuts and categories",
      "acceptanceCriteria": [
        "Command registry: registerCommand, getCommands, executeCommand",
        "Action commands: create nodes, switch view, export, toggle dark mode",
        "Navigation commands: recent nodes, project switching, settings",
        "Command categories: Navigation, Create, View, Actions groups",
        "Keyboard shortcut display with platform-aware symbols (âŒ˜ Mac, Ctrl Windows)",
        "Filter commands: filter by type, tag, status via command"
      ]
    },
    {
      "id": "10.1",
      "sprint": 10,
      "title": "Accessibility Audit & Fixes",
      "description": "WCAG 2.1 compliance verification and fixes",
      "tools": ["/rams", "/playwright"],
      "acceptanceCriteria": [
        "axe-core audit completed on all views",
        "Screen reader testing documented (VoiceOver, NVDA)",
        "All features accessible via keyboard",
        "Heading hierarchy correct (h1 -> h2 -> h3, no skips)",
        "Form labels correct (htmlFor or wrapping)",
        "Focus management logical (order, return focus)",
        "ARIA labels on icon buttons, landmarks, busy states",
        "focus-visible styles visible on Tab, not on click",
        "Color contrast meets 4.5:1 text, 3:1 UI",
        "Error messages use aria-describedby, aria-invalid",
        "44x44px minimum touch targets verified",
        "Lighthouse score >= 90"
      ]
    },
    {
      "id": "10.2",
      "sprint": 10,
      "title": "Dark Mode",
      "description": "Dark theme with system preference",
      "tools": ["/frontend-design"],
      "acceptanceCriteria": [
        "Dark mode theme using Tailwind dark: prefix",
        "All components visible in dark mode",
        "Dark mode toggle with color-scheme, theme-color meta",
        "Preference stored in localStorage and respects system preference"
      ]
    },
    {
      "id": "10.3",
      "sprint": 10,
      "title": "Reduced Motion & Loading States",
      "description": "Motion preferences and loading UI",
      "tools": ["/frontend-design", "/rams"],
      "acceptanceCriteria": [
        "prefers-reduced-motion disables animations",
        "Loading states use structural skeletons with aria-busy"
      ]
    },
    {
      "id": "10.4",
      "sprint": 10,
      "title": "Onboarding & Help",
      "description": "First-run experience and keyboard shortcuts reference",
      "tools": ["/frontend-design"],
      "acceptanceCriteria": [
        "First-run welcome dialog with quick tips for new users",
        "Keyboard shortcuts reference accessible via ? shortcut"
      ]
    },
    {
      "id": "10.5",
      "sprint": 10,
      "title": "Cross-Browser Testing",
      "description": "Verify core functionality across browsers",
      "tools": ["/playwright"],
      "acceptanceCriteria": [
        "Core functionality works in Chrome, Firefox, Safari, Edge"
      ]
    },
    {
      "id": "11.1",
      "sprint": 11,
      "title": "Workspace Management",
      "description": "Multi-project workspace with switcher and settings",
      "tools": ["/frontend-design"],
      "acceptanceCriteria": [
        "Workspace loader reads .forge/config.json, handles missing/corrupted config",
        "ProjectSwitcher dropdown with project list, active indicator, search/filter",
        "CreateProjectDialog with name input, folder selection, initialize structure",
        "Project settings panel: edit name/description, delete with confirmation"
      ]
    },
    {
      "id": "11.2",
      "sprint": 11,
      "title": "Git Integration",
      "description": "Git status and optional auto-commit",
      "tools": ["/frontend-design"],
      "acceptanceCriteria": [
        "Git status detection: repo, branch name, uncommitted changes",
        "Git status indicator: branch name, changes count, clean/dirty icon",
        "Auto-commit on save (optional setting): stage + commit when enabled",
        "Git settings UI: toggle auto-commit, view commits, manual commit"
      ]
    },
    {
      "id": "12.1",
      "sprint": 12,
      "title": "Production Build & Static Export",
      "description": "Optimize build for self-hosted deployment with configurable base path",
      "acceptanceCriteria": [
        "npm run build:prod generates optimized static files in dist/",
        "Configurable base path via VITE_BASE_PATH environment variable",
        "All assets use relative paths or respect base path",
        "Service worker for offline capability (optional)",
        "Build output includes version.json with build timestamp and git hash"
      ]
    },
    {
      "id": "12.2",
      "sprint": 12,
      "title": "Server-Side File System Adapter",
      "description": "File system adapter for server-hosted deployment with REST API",
      "acceptanceCriteria": [
        "ServerFileSystemAdapter implements FileSystemAdapter interface",
        "REST API endpoints: GET/PUT/DELETE /api/files/:path",
        "Directory listing endpoint: GET /api/files/:path?list=true",
        "File watching via polling or Server-Sent Events",
        "Authentication token support for API requests",
        "CORS configuration for Tailscale hostnames"
      ]
    },
    {
      "id": "12.3",
      "sprint": 12,
      "title": "Home Assistant Add-on Package",
      "description": "Package Forge as a Home Assistant add-on with configuration UI",
      "acceptanceCriteria": [
        "Add-on config.yaml with name, version, ports, options",
        "Dockerfile builds Node.js server with static files",
        "Data stored in /data (persistent across updates)",
        "Add-on options: port, base_path, auth_required",
        "Ingress support for seamless HA integration",
        "README with installation instructions for HACS or manual install"
      ]
    },
    {
      "id": "12.4",
      "sprint": 12,
      "title": "Tailscale Network Configuration",
      "description": "Documentation and configuration for Tailscale access",
      "acceptanceCriteria": [
        "TAILSCALE_HOSTNAME environment variable for CORS whitelist",
        "Documentation: enabling Tailscale on Home Assistant",
        "Documentation: accessing Forge via MagicDNS (e.g., homeassistant.tail1234.ts.net)",
        "Optional: Tailscale Funnel configuration for public sharing",
        "Security guidance: recommended Tailscale ACL policies"
      ]
    },
    {
      "id": "12.5",
      "sprint": 12,
      "title": "Docker Compose Deployment",
      "description": "Alternative deployment via Docker Compose for non-HA setups",
      "acceptanceCriteria": [
        "docker-compose.yml with forge service and volume mounts",
        "Dockerfile with multi-stage build (build + nginx)",
        "Environment variable configuration via .env file",
        "Health check endpoint at /api/health",
        "docker-compose.tailscale.yml variant with Tailscale sidecar container",
        "README with quick-start instructions"
      ]
    },
    {
      "id": "12.6",
      "sprint": 12,
      "title": "Backup & Sync",
      "description": "Backup mechanisms for self-hosted data",
      "acceptanceCriteria": [
        "Manual backup: export all projects as .zip via UI",
        "Scheduled backup option (daily/weekly) to configured path",
        "Restore from backup functionality",
        "Optional: sync to remote git repository on schedule",
        "Backup status indicator in settings"
      ]
    }
  ],
  "technicalDecisions": {
    "packageVersions": {
      "react": "18.x",
      "typescript": "5.x",
      "vite": "5.x",
      "tailwindcss": "3.x",
      "tailwindcss-animate": "latest",
      "@base-ui-components/react": "pin exact version (alpha)",
      "zustand": "4.x",
      "nuqs": "2.x",
      "gray-matter": "latest",
      "zod": "3.x",
      "reactflow": "11.x",
      "elkjs": "latest",
      "codemirror": "6.x",
      "lucide-react": "latest"
    },
    "fileSystemStrategy": [
      "Primary: File System Access API (Chrome/Edge)",
      "Fallback: <input type='file' webkitdirectory> (Firefox/Safari)",
      "Future: Local server adapter for Electron/Tauri"
    ],
    "zIndexScale": {
      "Z_DROPDOWN": 10,
      "Z_STICKY": 20,
      "Z_MODAL": 30,
      "Z_POPOVER": 40,
      "Z_TOAST": 50,
      "Z_TOOLTIP": 60
    },
    "colorTokens": {
      "decision": {
        "lightBg": "blue-50",
        "darkBg": "blue-950",
        "accent": "blue-500"
      },
      "component": {
        "lightBg": "green-50",
        "darkBg": "green-950",
        "accent": "green-500"
      },
      "task": {
        "lightBg": "orange-50",
        "darkBg": "orange-950",
        "accent": "orange-500"
      },
      "note": {
        "lightBg": "gray-50",
        "darkBg": "gray-900",
        "accent": "gray-500"
      }
    }
  },
  "references": {
    "sprintPlan": "SPRINT_PLAN.md",
    "spec": "spec.md",
    "progress": ".ralph/progress.md"
  }
}
